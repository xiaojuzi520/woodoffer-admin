(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-system-loginLog-list"],{"0801":function(e,t,a){"use strict";a.r(t);var r=a("4c1c"),n=a.n(r);for(var i in r)"default"!==i&&function(e){a.d(t,e,(function(){return r[e]}))}(i);t["default"]=n.a},"15fd":function(e,t,a){"use strict";a("a4d3"),a("c975"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var r=n(a("ccb5"));function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(null==e)return{};var a,n,i=(0,r.default)(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}},"3b0a":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformObjectEmptyString=void 0;var r=a("961d"),n=function(e){return(0,r.transform)(e,(function(e,t,a){""!==t&&(e[a]=t)}),{})};t.transformObjectEmptyString=n},"4c1c":function(e,t,a){"use strict";(function(e){var r=a("4ea4");a("d81d"),a("4d63"),a("ac1f"),a("25f0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a("15fd")),i=r(a("5530")),l=a("74f8"),o=a("3b0a"),s=e.database(),u="create_date desc",c={data:function(){var e=this;this.$createElement;return{searchForm:{username:"",nickName:"",mobile:"",origin:"",type:"",state:""},where:{},collection:"uni-id-log,uni-id-users",dbFields:"_id,user_id{nickName,mobile,username},type,ip,origin,state,deviceId,create_date",orderby:u,pageOptions:{size:20,current:1},selections:[],expData:[],expExcel:{filename:"用户登录日志.xls",type:"xls",json_fields:{ID:"_id","用户ID":"user_id","用户名":"username","用户昵称":"nickName","手机号":"mobile","登录类型":"typeStr","操作结果":"stateStr","平台":"origin",IP:"ip","创建时间":"create_date"}},tableColumns:[{label:"ID",prop:"_id",width:80},{label:"用户ID",prop:"user_id"},{label:"用户名",prop:"username"},{label:"用户昵称",prop:"nickName"},{label:"平台",prop:"origin",width:80},{label:"登录类型",prop:"type",width:80,render:function(e,t){var a=t.props.row,r={login:"",logout:"warning",register:"warning"},n=r[a.type],i=l.LoginEnum[a.type];return e("el-tag",{attrs:{effect:"dark",type:n}},[i])}},{label:"操作结果",prop:"state",width:80,render:function(e,t){var a=t.props.row,r=1===a.state,n=r?"success":"danger",i=r?"成功":"失败";return e("el-tag",{attrs:{type:n}},[i])}},{label:"IP",prop:"ip"},{label:"登录时间",prop:"create_date",formatter:function(t){return e.$formatDate(t.create_date)}}]}},methods:{getAllData:function(){var e=this;return s.collection(this.collection).where(this.where).field(this.dbFields).limit(500).get({getCount:!0}).then((function(t){var a=t.result,r=a.count,n=a.data;r>500?e.$message.warning("由于数据库性能原因，导出超过500条时，建议通过控制台进行全量导出"):e.expData=e.formatExcelData(n)})).catch((function(e){console.error(e)}))},formatExcelData:function(e){var t=this;return e.map((function(e){var a,r,n,o;return(0,i.default)((0,i.default)({},e),{},{create_date:t.$formatDate(e.create_date),nickName:null===(a=e.user_id[0])||void 0===a?void 0:a.nickName,mobile:null===(r=e.user_id[0])||void 0===r?void 0:r.mobile,user_id:null===(n=e.user_id[0])||void 0===n?void 0:n._id,username:null===(o=e.user_id[0])||void 0===o?void 0:o.username,typeStr:l.LoginEnum[e.type],origin:l.OriginTypeEnum[e.origin],stateStr:1===e.state?"成功":"失败"})}))},loadData:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$nextTick((function(){e.$refs.udb.loadData({clear:t})}))},getReg:function(e){return e?new RegExp(e,"i"):""},search:function(){var e=this.searchForm,t=e.username,a=e.nickName,r=e.mobile,l=(0,n.default)(e,["username","nickName","mobile"]),s=this.getReg,u=(0,i.default)((0,i.default)({},l),{},{"user_id.username":s(t),"user_id.nickName":s(a),"user_id.mobile":s(r)});this.where=(0,o.transformObjectEmptyString)(u),this.loadData()},onPageChanged:function(e){this.pageOptions=e}}};t.default=c}).call(this,a("a9ff")["default"])},"74f8":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginEnum=t.OriginTypeEnum=t.OperateEnum=t.CurrencyEnum=t.TradeTypeEnum=t.ProductTypeEnum=t.UserStatusEnum=void 0;var r=["激活","关停","待激活"];t.UserStatusEnum=r;var n=["期货","现货"];t.ProductTypeEnum=n;var i=["FOB","CIF"];t.TradeTypeEnum=i;var l=["RMB","USD","EUR"];t.CurrencyEnum=l;var o={create:"创建",update:"更新",delete:"删除"};t.OperateEnum=o;var s={mp:"微信",web:"网页"};t.OriginTypeEnum=s;var u={login:"登录",logout:"退出",register:"注册"};t.LoginEnum=u},ca38:function(e,t,a){"use strict";a.r(t);var r=a("da27"),n=a("0801");for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);var l,o=a("f0c5"),s=Object(o["a"])(n["default"],r["b"],r["c"],!1,null,"1449a1d6",null,!1,r["a"],l);t["default"]=s.exports},ccb5:function(e,t,a){"use strict";function r(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}a("c975"),a("b64b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},da27:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r}));var r={downloadExcel:a("f17b").default,unicloudDb:a("960d").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("v-uni-view",{staticClass:"uni-header"},[a("v-uni-view",{staticClass:"uni-group hide-on-phone"},[a("v-uni-view",{staticClass:"uni-title"},[e._v("用户登录日志管理")]),a("v-uni-view",{staticClass:"uni-sub-title"})],1),a("v-uni-view",{staticClass:"uni-group"},[a("download-excel",{staticClass:"hide-on-phone",attrs:{fields:e.expExcel.json_fields,data:e.expData,type:e.expExcel.type,name:e.expExcel.filename,beforeGenerate:e.getAllData}},[a("v-uni-button",{staticClass:"uni-button",attrs:{type:"primary",size:"mini"}},[e._v("导出 Excel")])],1)],1)],1),a("v-uni-view",{staticClass:"search"},[a("el-form",{attrs:{inline:!0,model:e.searchForm}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{placeholder:"用户名",clearable:!0},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1),a("el-form-item",{attrs:{label:"用户昵称"}},[a("el-input",{attrs:{placeholder:"用户昵称",clearable:!0},model:{value:e.searchForm.nickName,callback:function(t){e.$set(e.searchForm,"nickName",t)},expression:"searchForm.nickName"}})],1),a("el-form-item",{attrs:{label:"手机号"}},[a("el-input",{attrs:{placeholder:"手机号",maxlength:"11",clearable:!0},model:{value:e.searchForm.mobile,callback:function(t){e.$set(e.searchForm,"mobile",t)},expression:"searchForm.mobile"}})],1),a("el-form-item",{attrs:{label:"登录类型"}},[a("el-select",{attrs:{placeholder:"登录类型",clearable:!0},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},[a("el-option",{attrs:{label:"登录",value:"login"}}),a("el-option",{attrs:{label:"注册",value:"register"}})],1)],1),a("el-form-item",{attrs:{label:"操作结果"}},[a("el-select",{attrs:{placeholder:"操作结果",clearable:!0},model:{value:e.searchForm.state,callback:function(t){e.$set(e.searchForm,"state",t)},expression:"searchForm.state"}},[a("el-option",{attrs:{label:"成功",value:1}}),a("el-option",{attrs:{label:"失败",value:0}})],1)],1),a("el-form-item",{attrs:{label:"平台"}},[a("el-select",{attrs:{placeholder:"平台",clearable:!0},model:{value:e.searchForm.origin,callback:function(t){e.$set(e.searchForm,"origin",t)},expression:"searchForm.origin"}},[a("el-option",{attrs:{label:"微信",value:"mp"}}),a("el-option",{attrs:{label:"网页",value:"web"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.search.apply(void 0,arguments)}}},[e._v("查询")])],1)],1)],1),a("v-uni-view",{staticClass:"uni-container"},[a("unicloud-db",{ref:"udb",attrs:{collection:e.collection,options:e.pageOptions,where:e.where,field:e.dbFields,"page-data":"replace",orderby:e.orderby,getcount:!0,"page-size":e.pageOptions.size,"page-current":e.pageOptions.current},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data,n=t.pagination,i=t.loading;t.error;return[a("xl-table",{attrs:{"table-data":e.formatExcelData(r),"table-columns":e.tableColumns,loading:i,count:n.count,"page-size":n.size,"page-no":n.current},on:{"change-page":function(t){arguments[0]=t=e.$handleEvent(t),e.onPageChanged.apply(void 0,arguments)}}})]}}])})],1)],1)},i=[]}}]);